"""
This code file is for figuring how to implement custom sampling stepmethods since for some reason it isn't working in another code file

Active notes:
My working theory as to why custom sampling fails on Hierarch.py is because there are multiple models where I have used the same RV names in both models (eta_sep,a_sep...etc) and this could be causing the issue, if so then I will have to change names but this will take a bit of time. In isolating the M=3 model I also want to solve the loop fusion warning that occurs
"""

"""
import arviz as az
import matplotlib.pyplot as plt
import numpy as np
import pymc as pm
import scipy as sp
import scipy.stats
import pytensor.tensor as pt
import multiprocessing

def main():
    cpucount=multiprocessing.cpu_count()
    RANDOM_SEED = 0
    np.random.seed(RANDOM_SEED)
    az.style.use("arviz-darkgrid")


    #####################Data generation

    Vmax=10
    N=100 #Top of page 108 ->N=number of experiments

    V_2_dist=np.random.uniform(low=0, high=Vmax,size=2*N).reshape(2,N)
    #V_dist+=rng.normal(scale=0.02, size=(12,N)) #Adding gaussian noise, top of page 108 says 2% voltage noise
    #M=2

    eta_2_true=[np.random.normal(loc=0.5,scale=0.05) for i in range(2)]
    theta_2_true=2*np.arccos(np.sqrt(eta_2_true))
    a_2_true=[np.random.normal(loc=0,scale=np.pi/200) for i in range(2)]
    #print(a_2_true[0])
    b_2_true=[np.random.normal(loc=0.7,scale=0.07) for i in range(2)]


    eta_2_est=eta_2_true+np.random.normal(loc=0,scale=0.05,size=len(eta_2_true))
    #theta_est=2*np.acos(np.sqrt(eta_est))
    a_2_est=a_2_true+np.random.normal(loc=0,scale=np.pi/200,size=len(a_2_true))
    b_2_est=b_2_true+np.random.normal(loc=0,scale=0.07,size=len(b_2_true))

    def DataGen(InputNumber, Voltages1, poissonian=True): #InputNumber=# of input photons= should average to about 1000

        #M=2

        #phi_2_true=a_2_true+b_2_true*np.square(Voltages1) #phi=a+bV**2
        phi_2_true=np.square(Voltages1)
        #print(phi_2_true)
        for _ in range(len(phi_2_true)):
            phi_2_true[_]= a_2_true[_]+b_2_true[_]*phi_2_true[_]
        
        P_click1_true=-np.sin(theta_2_true[0])*np.sin(theta_2_true[1])*np.cos(phi_2_true[0])/2 + np.cos(theta_2_true[0])*np.cos(theta_2_true[1])/2 + 1/2
        P_click2_true=-np.cos(theta_2_true[0] - theta_2_true[1])/4 - np.cos(theta_2_true[0] + theta_2_true[1])/4 - np.cos(-phi_2_true[0] + theta_2_true[0] + theta_2_true[1])/8 + np.cos(phi_2_true[0] - theta_2_true[0] + theta_2_true[1])/8 + np.cos(phi_2_true[0] + theta_2_true[0] - theta_2_true[1])/8 - np.cos(phi_2_true[0] + theta_2_true[0] + theta_2_true[1])/8 + 1/2
        P_true_2=[P_click1_true,P_click2_true]
        P_2=np.transpose(np.row_stack(P_true_2))
        #n=C,p=P,x=array of clicks
        data_2=[]
        C_2=[]
        for i in range(N):
            data_2.append(scipy.stats.multinomial.rvs(n=InputNumber,p=P_2[i]))
            C_2.append(np.sum(data_2[i]))
        #Need to add poissonian noise
        #if poissonian==True:
        #    data[i]+=rng.poisson(size=len(data[i]))

        return data_2,C_2,P_2

    data_2, C_2, P_2 = DataGen(InputNumber=1000,Voltages1=V_2_dist, poissonian=False)


    L_dev=4E-9 #delta L, chosen so it coincides with Alex's sd to be ~np.pi/200
    wv=1550E-9
    a_dev=(2*np.pi*L_dev)/wv

    with pm.Model() as model_multinomial1:
        #M=2

        # Define priors
        #sd=0.05
        eta_sep=pm.TruncatedNormal("eta_sep",mu=0,sigma=1,lower=0.0,upper=1.0,shape=2) #array of
        eta=pm.Deterministic("eta",[0.5,0.5]+eta_sep*0.05)
        theta=pm.Deterministic("theta",2*pt.arccos(pt.sqrt(eta)))
        #priors for conciseness

        #sd=a_dev
        a_sep=pm.TruncatedNormal("a_sep", mu=0, sigma=1,lower=-np.pi,upper=np.pi, shape=2)  #array of priors for conciseness
        a=pm.Deterministic("a",[0,0]+a_sep*a_dev)

        sd=0.7
        b_sep=pm.Normal("b_sep", mu=0, sigma=1,shape=2) #array of priors for conciseness
        b=pm.Deterministic("b",[0.7,0.7]+b_sep*sd)

        #Have decided to open the Volt variable to allow additional freedom
        Volt=pm.Normal("Volt",mu=V_2_dist,sigma=0.1)
        #Volt=pm.Deterministic("Volt",pt.as_tensor(V_2_dist))
        
        phi=pm.Deterministic("phi",a[:,None]+b[:,None]*pm.math.sqr(Volt))
        
        #phi1 vanishes from p expression under simplification
        p1=pm.Deterministic("p1",-pm.math.sin(theta[0])*pm.math.sin(theta[1])*pm.math.cos(phi[0])/2 + pm.math.cos(theta[0])*pm.math.cos(theta[1])/2 + 1/2)
        p2=pm.Deterministic("p2",-pm.math.cos(theta[0] - theta[1])/4 - pm.math.cos(theta[0] + theta[1])/4 - pm.math.cos(-phi[0] + theta[0] + theta[1])/8 + pm.math.cos(phi[0] - theta[0] + theta[1])/8 + pm.math.cos(phi[0] + theta[0] - theta[1])/8 - pm.math.cos(phi[0] + theta[0] + theta[1])/8 + 1/2)

        P=pm.Deterministic("P",pm.math.stack([p1,p2],axis=-1))
        likelihood=pm.Multinomial("likelihood",n=1000,p=P[0],shape=(N,2),observed=data_2)

    print(model_multinomial1.free_RVs)

    with model_multinomial1:

        stepmethod=[pm.NUTS([a_sep]),pm.NUTS([a_sep,b_sep]),pm.NUTS([a_sep,b_sep,eta_sep])]

        trace_multinomial_2_HMC = pm.sample(draws=int(1e3), chains=4, cores=cpucount,step=stepmethod, return_inferencedata=True)

    az.plot_trace(data=trace_multinomial_2_HMC,var_names=["eta","a","b"],divergences=True)
if __name__=='__main__':
    main()
"""
"""
import arviz as az
import matplotlib.pyplot as plt
import numpy as np
import pymc as pm
import scipy as sp
import scipy.stats
import pytensor.tensor as pt
import multiprocessing

def main():
    cpucount=multiprocessing.cpu_count()
    RANDOM_SEED = 0
    np.random.seed(RANDOM_SEED)
    az.style.use("arviz-darkgrid")


    #####################Data generation

    Vmax=10
    N=100 #Top of page 108 ->N=number of experiments

    V_3_dist=np.random.uniform(low=0, high=Vmax,size=6*N).reshape(6,N)
    #V_dist+=rng.normal(scale=0.02, size=(12,N)) #Adding gaussian noise, top of page 108 says 2% voltage noise
    #M=3

    eta_3_true=[np.random.normal(loc=0.5,scale=0.05) for i in range(6)]
    theta_3_true=2*np.arccos(np.sqrt(eta_3_true))
    a_3_true=[np.random.normal(loc=0,scale=np.pi/200) for i in range(6)]
    b_3_true=[np.random.normal(loc=0.7,scale=0.07) for i in range(6)]

    eta_3_est=eta_3_true+np.random.normal(loc=0,scale=0.05,size=len(eta_3_true))
    #theta_3_est=2*np.acos(np.sqrt(eta_3_est))
    a_3_est=a_3_true+np.random.normal(loc=0,scale=np.pi/200,size=len(a_3_true))
    b_3_est=b_3_true+np.random.normal(loc=0,scale=0.07,size=len(b_3_true))

    def DataGen(InputNumber, Voltages2, poissonian=True): #InputNumber=# of input photons= should average to about 1000
        #M=3

        phi_3_true=np.square(Voltages2)
        for _ in range(len(phi_3_true)):
            phi_3_true[_]= a_3_true[_]+b_3_true[_]*phi_3_true[_]
        P_click1_true=-4*np.sin(phi_3_true[0])*np.sin(phi_3_true[1])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[0])*np.sin(phi_3_true[1])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) + 2*np.sin(phi_3_true[0])*np.sin(phi_3_true[1])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[2] + phi_3_true[3]) + 4*np.sin(phi_3_true[0])*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(phi_3_true[0])*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(phi_3_true[1])*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[3] - phi_3_true[4]) + 4*np.sin(phi_3_true[1])*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[3] - phi_3_true[4]) - 4*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[0] + phi_3_true[2] + phi_3_true[3]) + 2*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] + phi_3_true[3]) - 4*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) - 2*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(phi_3_true[0] - phi_3_true[3])*np.cos(phi_3_true[1])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) - 2*np.sin(phi_3_true[2])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] - phi_3_true[3])*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[2])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[0] + phi_3_true[1])*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.sin(phi_3_true[0] + phi_3_true[1])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) - 2*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(phi_3_true[0] + phi_3_true[1])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) - 2*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[0] + phi_3_true[1] - phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(phi_3_true[3])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[2])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2 - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2 - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2 + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[4]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[0]/2)**2 + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3]) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3]) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[3])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[2]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[2]) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[2]) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[0] - phi_3_true[2])*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[0] - phi_3_true[2])*np.cos(phi_3_true[3] - phi_3_true[4]) - 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 + 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2 - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2 + 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 - 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2 + 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[1]/2)**2 - 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) + 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) + 2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[4]/2)**2 - 2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - np.sin(theta_3_true[5]/2)**2 + 1
        P_click2_true=4*np.sin(phi_3_true[0])*np.sin(phi_3_true[1])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] + phi_3_true[3]) + 4*np.sin(phi_3_true[0])*np.sin(phi_3_true[1])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[2] + phi_3_true[3]) - 2*np.sin(phi_3_true[0])*np.sin(phi_3_true[1])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) + 2*np.sin(phi_3_true[0])*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 2*np.sin(phi_3_true[0])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(phi_3_true[0])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[2] + phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] + phi_3_true[4]) + 2*np.sin(phi_3_true[1])*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[3] - phi_3_true[4]) + 2*np.sin(phi_3_true[1])*np.sin(phi_3_true[2])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[3] - phi_3_true[4]) + 4*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] + phi_3_true[3]) + 4*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] + phi_3_true[3]) - 2*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(phi_3_true[1])*np.sin(phi_3_true[4])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[3])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) - 2*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(phi_3_true[2])*np.sin(phi_3_true[3])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] - phi_3_true[3])*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] - phi_3_true[3])*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[0] - phi_3_true[3])*np.cos(phi_3_true[1])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[2])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.sin(phi_3_true[0] - phi_3_true[3])*np.cos(phi_3_true[1])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) - 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[2])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[0] + phi_3_true[1])*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.sin(phi_3_true[0] + phi_3_true[1])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) + 2*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(phi_3_true[0] + phi_3_true[1])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2) + 2*np.sin(phi_3_true[3])*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[0] - phi_3_true[2]) + 2*np.sin(phi_3_true[3])*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.sin(phi_3_true[1] + phi_3_true[4])*np.cos(phi_3_true[2])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2) - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2 + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2 - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2 + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)**2 - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 8*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 + 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[3]/2)**2 + 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[4]/2)**2 - 4*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[0]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[0]/2)**2 - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[2])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[3]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) - 8*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[1]/2)*np.cos(phi_3_true[0])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[1]/2) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3]) + 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3]) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3]) - 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[0] + phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[3])*np.cos(phi_3_true[4])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[2]) - 4*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[0])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[2]) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[4]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[2]) + 2*np.sin(theta_3_true[0]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[0])*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[0]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) + 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 - 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[3]/2)**2 - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)**2 + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)**2 - 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) + 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[2])*np.cos(phi_3_true[4])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.cos(phi_3_true[2])*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2) - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)**2 + 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2*np.sin(theta_3_true[5]/2)**2 - np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[3]/2)**2 + 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)**2 - 4*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) - 2*np.sin(theta_3_true[1]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[1]/2)**2 + 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) + 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[4]/2)*np.cos(phi_3_true[1] - phi_3_true[3]) - 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[2]/2)*np.sin(theta_3_true[3]/2)*np.sin(theta_3_true[5]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[1] - phi_3_true[3] + phi_3_true[4]) - 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) - 4*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)**2*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[4]/2)*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[4]/2)*np.cos(-phi_3_true[1] + phi_3_true[2] + phi_3_true[3]) + 2*np.sin(theta_3_true[1]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[1])*np.cos(phi_3_true[3])*np.cos(theta_3_true[1]/2)*np.cos(theta_3_true[2]/2)*np.cos(theta_3_true[3]/2)*np.cos(theta_3_true[5]/2)*np.cos(phi_3_true[2] - phi_3_true[4]) - 2*np.sin(theta_3_true[4]/2)**2*np.sin(theta_3_true[5]/2)**2 + np.sin(theta_3_true[4]/2)**2 + 2*np.sin(theta_3_true[4]/2)*np.sin(theta_3_true[5]/2)*np.cos(phi_3_true[4])*np.cos(theta_3_true[4]/2)*np.cos(theta_3_true[5]/2) + np.sin(theta_3_true[5]/2)**2
        P_click3_true=(-2*np.cos(theta_3_true[0] - theta_3_true[1]) - 2*np.cos(theta_3_true[0] + theta_3_true[1]) - np.cos(-phi_3_true[0] + theta_3_true[0] + theta_3_true[1]) + np.cos(phi_3_true[0] - theta_3_true[0] + theta_3_true[1]) + np.cos(phi_3_true[0] + theta_3_true[0] - theta_3_true[1]) - np.cos(phi_3_true[0] + theta_3_true[0] + theta_3_true[1]) + 4)*(-2*np.cos(theta_3_true[2] - theta_3_true[3]) - 2*np.cos(theta_3_true[2] + theta_3_true[3]) - np.cos(-phi_3_true[2] + theta_3_true[2] + theta_3_true[3]) + np.cos(phi_3_true[2] - theta_3_true[2] + theta_3_true[3]) + np.cos(phi_3_true[2] + theta_3_true[2] - theta_3_true[3]) - np.cos(phi_3_true[2] + theta_3_true[2] + theta_3_true[3]) + 4)/64
        P_true_3=[P_click1_true,P_click2_true,P_click3_true]
        P_3=np.transpose(np.row_stack(P_true_3))
        #n=C,p=P,x=array of clicks
        data_3=[]
        C_3=[]
        for i in range(N):
            data_3.append(scipy.stats.multinomial.rvs(n=InputNumber,p=P_3[i]))
            C_3.append(np.sum(data_3[i]))
        #Need to add poissonian noise
        #if poissonian==True:
        #    data[i]+=rng.poisson(size=len(data[i]))

        return data_3,C_3,P_3

    data_3,C_3,P_3=DataGen(InputNumber=1000,Voltages2 = V_3_dist, poissonian=False)


    L_dev=4E-9 #delta L, chosen so it coincides with Alex's sd to be ~np.pi/200
    wv=1550E-9
    a_dev=(2*np.pi*L_dev)/wv
    
    with pm.Model() as model_multinomial2:
        #M=3

        # Define priors
        eta_sep=pm.TruncatedNormal("eta_sep",mu=0,sigma=1,lower=0.0,upper=1.0,shape=6) #array of
        eta=pm.Deterministic("eta",[0.5,0.5,0.5,0.5,0.5,0.5]+eta_sep*0.05)
        theta=pm.Deterministic("theta",2*pt.arccos(pt.sqrt(eta)))
        #priors for conciseness

        #sd=a_dev
        a_sep=pm.TruncatedNormal("a_sep", mu=0, sigma=1,lower=-np.pi,upper=np.pi, shape=6)  #array of priors for conciseness
        a=pm.Deterministic("a",[0,0,0,0,0,0]+a_sep*a_dev)

        sd=0.7
        #b can seem to become quite sharp or different distributions having different widths? Plus lack of agreement between chains
        b_sep=pm.Normal("b_sep", mu=0, sigma=1,shape=6) #array of priors for conciseness
        b=pm.Deterministic("b",[0.5,0.5,0.5,0.5,0.5,0.5]+b_sep*sd)
        
        #Volt=pm.Deterministic("Volt",pt.as_tensor(V_3_dist))
        Volt=pm.Normal("Volt",mu=V_3_dist,sigma=0.1) #This really brutalises the output
        phi=pm.Deterministic("phi",a[:,None]+b[:,None]*pm.math.sqr(Volt))

        p1=pm.Deterministic("p1",-4*pm.math.sin(phi[0])*pm.math.sin(phi[1])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[0])*pm.math.sin(phi[1])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) + 2*pm.math.sin(phi[0])*pm.math.sin(phi[1])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[2] + phi[3]) + 4*pm.math.sin(phi[0])*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(phi[0])*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(phi[1])*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[3] - phi[4]) + 4*pm.math.sin(phi[1])*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[3] - phi[4]) - 4*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[0] + phi[2] + phi[3]) + 2*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] + phi[3]) - 4*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) - 2*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(phi[0] - phi[3])*pm.math.cos(phi[1])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) - 2*pm.math.sin(phi[2])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] - phi[3])*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[2])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.sin(phi[0] + phi[1])*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.sin(phi[0] + phi[1])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) - 2*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(phi[0] + phi[1])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) - 2*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[0] + phi[1] - phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(phi[3])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[2])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2 - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2 - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2 + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3] + phi[4]) - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[4]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[0]/2)**2 + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3] + phi[4]) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[0] + phi[1] - phi[3]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[0] + phi[1] - phi[3]) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[0] + phi[1] - phi[3]) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[0] + phi[1] - phi[3] + phi[4]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[3])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[2]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[2]) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[2]) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[0] - phi[2])*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[0] - phi[2])*pm.math.cos(phi[3] - phi[4]) - 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 + 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2 - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2 + 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 - 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2 + 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[1]/2)**2 - 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) - 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3] + phi[4]) + 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) + 2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[4]/2)**2 - 2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - pm.math.sin(theta[5]/2)**2 + 1)
        p2=pm.Deterministic("p2",4*pm.math.sin(phi[0])*pm.math.sin(phi[1])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] + phi[3]) + 4*pm.math.sin(phi[0])*pm.math.sin(phi[1])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[2] + phi[3]) - 2*pm.math.sin(phi[0])*pm.math.sin(phi[1])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) + 2*pm.math.sin(phi[0])*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 2*pm.math.sin(phi[0])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(phi[0])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[2] + phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] + phi[4]) + 2*pm.math.sin(phi[1])*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[3] - phi[4]) + 2*pm.math.sin(phi[1])*pm.math.sin(phi[2])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[3] - phi[4]) + 4*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] + phi[3]) + 4*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] + phi[3]) - 2*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(phi[1])*pm.math.sin(phi[4])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[3])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) - 2*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(phi[2])*pm.math.sin(phi[3])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] - phi[3])*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] - phi[3])*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.sin(phi[0] - phi[3])*pm.math.cos(phi[1])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[2])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.sin(phi[0] - phi[3])*pm.math.cos(phi[1])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) - 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[2])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.sin(phi[0] + phi[1])*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.sin(phi[0] + phi[1])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) + 2*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(phi[0] + phi[1])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2) + 2*pm.math.sin(phi[3])*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[0] - phi[2]) + 2*pm.math.sin(phi[3])*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.sin(phi[1] + phi[4])*pm.math.cos(phi[2])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2) - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2 + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2 - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2 + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)**2 - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) - 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3] + phi[4]) + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 8*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 + 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[3]/2)**2 + 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[4]/2)**2 - 4*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[0]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[0]/2)**2 - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3] + phi[4]) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[2])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[3]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) - 8*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[1]/2)*pm.math.cos(phi[0])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[1]/2) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[0] + phi[1] - phi[3]) + 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[0] + phi[1] - phi[3]) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[0] + phi[1] - phi[3]) - 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[0]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[0] + phi[1] - phi[3] + phi[4]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[3])*pm.math.cos(phi[4])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[2]) - 4*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[0])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[2]) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[2]) + 2*pm.math.sin(theta[0]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[0])*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[0]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) + 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 - 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[3]/2)**2 - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)**2 + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)**2 - 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) + 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[2])*pm.math.cos(phi[4])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.cos(phi[2])*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2) - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)**2 + 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2*pm.math.sin(theta[5]/2)**2 - pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[3]/2)**2 + 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)**2 - 4*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) - 2*pm.math.sin(theta[1]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[1]/2)**2 + 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3]) + 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(phi[1] - phi[3]) - 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[2]/2)*pm.math.sin(theta[3]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[1] - phi[3] + phi[4]) - 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) - 4*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)**2*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[4]/2)*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[4]/2)*pm.math.cos(-phi[1] + phi[2] + phi[3]) + 2*pm.math.sin(theta[1]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[1])*pm.math.cos(phi[3])*pm.math.cos(theta[1]/2)*pm.math.cos(theta[2]/2)*pm.math.cos(theta[3]/2)*pm.math.cos(theta[5]/2)*pm.math.cos(phi[2] - phi[4]) - 2*pm.math.sin(theta[4]/2)**2*pm.math.sin(theta[5]/2)**2 + pm.math.sin(theta[4]/2)**2 + 2*pm.math.sin(theta[4]/2)*pm.math.sin(theta[5]/2)*pm.math.cos(phi[4])*pm.math.cos(theta[4]/2)*pm.math.cos(theta[5]/2) + pm.math.sin(theta[5]/2)**2)
        p3=pm.Deterministic("p3",(-2*pm.math.cos(theta[0] - theta[1]) - 2*pm.math.cos(theta[0] + theta[1]) - pm.math.cos(-phi[0] + theta[0] + theta[1]) + pm.math.cos(phi[0] - theta[0] + theta[1]) + pm.math.cos(phi[0] + theta[0] - theta[1]) - pm.math.cos(phi[0] + theta[0] + theta[1]) + 4)*(-2*pm.math.cos(theta[2] - theta[3]) - 2*pm.math.cos(theta[2] + theta[3]) - pm.math.cos(-phi[2] + theta[2] + theta[3]) + pm.math.cos(phi[2] - theta[2] + theta[3]) + pm.math.cos(phi[2] + theta[2] - theta[3]) - pm.math.cos(phi[2] + theta[2] + theta[3]) + 4)/64)
        
        P=pm.Deterministic("P",pm.math.stack([p1,p2,p3],axis=-1))
        
        likelihood=pm.Multinomial("likelihood",n=1000,p=P[0],shape=(N,3),observed=data_3)
    

    print(model_multinomial2.free_RVs)
     
    with model_multinomial2:

        stepmethod=[pm.NUTS([a_sep]),pm.NUTS([a_sep,b_sep]),pm.NUTS([a_sep,b_sep,eta_sep])]

        trace_multinomial_3_HMC = pm.sample(draws=int(1e3), chains=4, cores=cpucount,step=stepmethod,return_inferencedata=True)
    
    
if __name__=='__main__':
    main()
"""

import arviz as az
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import pymc as pm
import xarray as xr

from pymc import HalfCauchy, Model, Normal, sample

print(f"Running on PyMC v{pm.__version__}")
RANDOM_SEED = 8927
rng = np.random.default_rng(RANDOM_SEED)


az.style.use("arviz-darkgrid")

def main():
    size = 200
    true_intercept = 1
    true_slope = 2

    x = np.linspace(0, 1, size)
    # y = a + b*x
    true_regression_line = true_intercept + true_slope * x
    # add noise
    y = true_regression_line + rng.normal(scale=0.5, size=size)

    data = pd.DataFrame(dict(x=x, y=y))

    with Model() as model1:  # model specifications in PyMC are wrapped in a with-statement
        # Define priors
        sigma = HalfCauchy("sigma", beta=10)
        intercept = Normal("intercept", 0, sigma=20)
        slope = Normal("slope", 0, sigma=20)

        # Define likelihood
        likelihood = Normal("y", mu=intercept + slope * x, sigma=sigma, observed=y)


    with Model() as model2:
        # Define priors
        sigma = Normal("sigma", 0,sigma=1)
        intercept = Normal("intercept", 0, sigma=20)
        slope = Normal("slope", 0, sigma=20)

        # Define likelihood
        likelihood = Normal("y", mu=intercept + slope * x, sigma=sigma, observed=y)

    #print(model1["sigma","slope"])
    with model1:
        #stepmethod=[pm.NUTS([model1["sigma"]]),pm.NUTS([model1["sigma"],model1["slope"],model1["intercept"]])]
        step1=pm.NUTS([model1["sigma"]])
        step2=pm.NUTS([model1["sigma"],model1["slope"],model1["intercept"]])
        stepmethod=[step1,step2]
        samples1=sample(1000,step=stepmethod)

    with model2:
        stepmethod=[pm.NUTS([model2["sigma"]]),pm.NUTS([model2["sigma"],model2["slope"]]), pm.NUTS([model2["sigma"],model2["slope"],model2["intercept"]])]

        samples2=sample(1000,step=stepmethod)
    
if __name__=='__main__':
    main()